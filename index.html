<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reminder Notifications</title>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
    <input id="primary">
    <p>Current permission status is <b id="status">...</b>.</p>
    <p><button class="btn btn-default" onclick="display()">Show Notification</button></p>
    <script>
        var $status = document.getElementById('status');

        function myFunction() {
            msg = document.getElementById("primary").value;
            console.log(msg);
        };

        document.getElementById("primary").onkeyup = function() {
            myFunction()
        };

        if ('Notification' in window) {
            $status.innerText = Notification.permission;
        }

        function requestPermission() {
            if (!('Notification' in window)) {
                alert('Notification API not supported!');
                return;
            }

            Notification.requestPermission(function(result) {
                $status.innerText = result;
            });
        }

        function nonPersistentNotification() {
            if (!('Notification' in window)) {
                alert('Notification API not supported!');
                return;
            }

            try {
                var notification = new Notification(msg, hello);
            } catch (err) {
                alert('Notification API error: ' + err);
            }
        }

        function persistentNotification() {
            if (!('Notification' in window) || !('ServiceWorkerRegistration' in window)) {
                alert('Persistent Notification API not supported!');
                return;
            }

            try {
                navigator.serviceWorker.getRegistration()
                    .then(reg => reg.showNotification(msg))
                // .catch(err => alert('Service Worker registration error: ' + err));
            } catch (err) {
                alert('Notification API error: ' + err);
            }
        }
        // Registering ServiceWorker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(function(registration) {
                // Registration was successful
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }).catch(function(err) {
                // registration failed :(
                console.log('ServiceWorker registration failed: ', err);
            });
        }

        function display() {
            requestPermission();
            try {
                persistentNotification();
                console.log(msg);
            } catch (err) {
                nonPersistentNotification();
            }
        }
    </script>
</body>

</html>